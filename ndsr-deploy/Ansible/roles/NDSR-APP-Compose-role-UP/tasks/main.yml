- name: Copy files for ndsr-app
  ansible.builtin.copy:
    src: ../../../../ndsr-app
    dest: /home/{{ admin }}

- name: Copy files for ndsr-app-backend
  template:
    src: .env.example_back.j2
    dest: /home/{{ admin }}/ndsr-app/api/.env.example

- name: Copy files for ndsr-app-frontend
  template:
    src: .env.example_front.j2
    dest: /home/{{ admin }}/ndsr-app/.env

- name: Create Dockerfile Webtelnet image's and copy to docker host
  template:
    src: Dockerfile.j2
    dest: /home/{{ admin }}/Dockerfile_webtelnet

- name: Copy app docker-compose file to remote host
  template:
   src: ndsr-app.yml.j2
   dest: /home/{{ admin }}/ndsr-app.yml

- name: Copy app env file to remote host
  copy:
   src: VARS-APP.env
   dest: /home/{{ admin }}

- name: Run `docker-compose APP up`
  community.docker.docker_compose_v2:
     project_src: /home/{{ admin }}
     files: ndsr-app.yml
     project_name: ndsr-app
     env_files: VARS-APP.env
  register: output

- name: Show results
  debug:
     var: output